(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{64:function(e,t,n){e.exports=n(93)},93:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),u=n.n(c),s=n(7),l=n(6),o=n(95),i=n(35),m=n(59),f=n(21),h=n(26),p=n(13),d=n.n(p),b=n(22),E=n(47),v=n.n(E),g=v.a.create({baseURL:"https://enigmatic-wildwood-39578.herokuapp.com/"}),k=v.a.create({baseURL:"https://enigmatic-wildwood-39578.herokuapp.com/"});k.interceptors.request.use(function(e){return e.headers.authorization="Bearer ".concat(localStorage.getItem("token")),e});var j=n(33),O=function(){var e=Object(b.a)(d.a.mark(function e(t,n,a){var r,c,u,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Date,c=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate(),e.next=3,g.post("api/user/registration",{name:t,email:n,password:a,dataRegistration:c,dateLastAuthorization:c,status:"unblock"});case 3:return u=e.sent,s=u.data,localStorage.setItem("token",s.token),e.abrupt("return",Object(j.a)(s.token));case 7:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),w=function(){var e=Object(b.a)(d.a.mark(function e(t,n){var a,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.post("api/user/login",{email:t,password:n});case 2:return a=e.sent,r=a.data,localStorage.setItem("token",r.token),e.abrupt("return",Object(j.a)(r.token));case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(b.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get("api/user/auth");case 2:return t=e.sent,n=t.data,localStorage.setItem("token",n.token),e.abrupt("return",Object(j.a)(n.token));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(b.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get("api/user/users");case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(b.a)(d.a.mark(function e(t,n){var a,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.put("api/user/status",{status:n,users:t});case 2:return a=e.sent,r=a.data,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),_=function(){var e=Object(b.a)(d.a.mark(function e(t){var n,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.delete("api/user/user",{users:t});case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),N=function(e){var t=e.user,n=Object(a.useContext)(Q).user;return r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",checked:t.selected,id:t.id,onChange:function(){return n.setSelected(t.id)}})),r.a.createElement("td",null,t.id),r.a.createElement("td",null,t.name),r.a.createElement("td",null,t.email),r.a.createElement("td",null,t.dateregistration),r.a.createElement("td",null,t.datelastauthorization),r.a.createElement("td",null,t.status))},S=Object(h.a)(function(){var e=Object(a.useContext)(Q).user,t=Object(l.f)(),n=Object(a.useState)(!1),c=Object(s.a)(n,2),u=c[0],h=c[1],p=e._users.filter(function(e){return e.selected}).length===e._users.length;Object(a.useEffect)(function(){y().then(function(t){return e.setUsers(t)})},[]);var d=function(n){var a=Object(j.a)(localStorage.token);console.log(a.status);var r=e._users.filter(function(e){return e.selected}),c=r.find(function(e){return e.id===a.id});C(r,n).then(function(){return e.setStatus(n)}),c&&(e.setIsAuth(!1),t("/login"))};return r.a.createElement(o.a,{className:"d-flex flex-column align-items-center mb-2"},r.a.createElement(i.a,null,r.a.createElement("h2",{className:"m-auto"},"Task #3")),r.a.createElement(i.a,{className:"d-flex flex-row"},r.a.createElement(f.a,{variant:"outline-success",onClick:function(){return d("block")}},"Block"),r.a.createElement(f.a,{variant:"outline-success",onClick:function(){return d("unBlock")}},"Unblock"),r.a.createElement(f.a,{variant:"outline-success",onClick:function(){return function(){var t=e._users.filter(function(e){return e.selected});_(t).then(function(t){return e.setUsers(t)})}()}},"Delete")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(m.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},r.a.createElement("input",{type:"checkbox",checked:p,className:"form-check-input",id:"mastercheck",onChange:function(){h(!u),e.setSelectedAll(u)}})),r.a.createElement("th",null,"Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"Data registration"),r.a.createElement("th",null,"Data last authorisation"),r.a.createElement("th",null,"Status"))),r.a.createElement("tbody",null,e._users.map(function(e){return r.a.createElement(N,{user:e})}))))))}),A=function(){return r.a.createElement("div",null,"MyPage")},I=n(99),U=n(98),D=n(24),L=Object(h.a)(function(){var e=Object(a.useContext)(Q).user,t=Object(l.e)(),n=Object(l.f)(),c="/login"===t.pathname,u=Object(a.useState)(""),m=Object(s.a)(u,2),h=m[0],p=m[1],E=Object(a.useState)(""),v=Object(s.a)(E,2),g=v[0],k=v[1],j=Object(a.useState)(""),x=Object(s.a)(j,2),y=x[0],C=x[1],_=function(){var t=Object(b.a)(d.a.mark(function t(){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=new Date,a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear(),t.prev=1,!c){t.next=8;break}return t.next=5,w(h,y);case 5:t.sent,t.next=11;break;case 8:return t.next=10,O(g,h,y);case 10:t.sent;case 11:e.setUser(e),e.setIsAuth(!0),n("/admin"),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),alert(t.t0.response.data.message);case 19:case"end":return t.stop()}},t,null,[[1,16]])}));return function(){return t.apply(this,arguments)}}();return r.a.createElement(o.a,{className:"d-flex justify-content-center align-items-center",style:{height:window.innerHeight-54}},r.a.createElement(I.a,{style:{width:600},className:"p-5"},r.a.createElement("h2",{className:"m-auto"},c?"Authorisation":"Registration"),r.a.createElement(U.a,{className:"d-flex flex-column"},c?null:r.a.createElement(U.a.Control,{className:"mt-2",placeholder:"Enter your name",value:g,onChange:function(e){return k(e.target.value)}}),r.a.createElement(U.a.Control,{className:"mt-2",placeholder:"Enter your email",value:h,onChange:function(e){return p(e.target.value)}}),r.a.createElement(U.a.Control,{className:"mt-2",placeholder:"Enter your password",value:y,onChange:function(e){return C(e.target.value)},type:"password"}),r.a.createElement(i.a,{className:"d-flex justify-content-between mt-3 pl-5 pr-5"},c?r.a.createElement("div",null,"No account? ",r.a.createElement(D.b,{to:"/registration"},"Sign up")):r.a.createElement("div",null,"Have an account? ",r.a.createElement(D.b,{to:"/login"},"Log in")),r.a.createElement(f.a,{variant:"outline-success",onClick:_},c?"Log in":"Registration")))))}),R=[{path:"/admin",Component:S},{path:"/myPage",Component:A}],z=[{path:"/registration",Component:L},{path:"/login",Component:L}],B=function(){var e=Object(a.useContext)(Q).user;return r.a.createElement(l.c,null,e.isAuth&&R.map(function(e){var t=e.path,n=e.Component;return r.a.createElement(l.a,{key:t,path:t,element:r.a.createElement(n,null),exact:!0})}),z.map(function(e){var t=e.path,n=e.Component;return r.a.createElement(l.a,{key:t,path:t,element:r.a.createElement(n,null),exact:!0})}))},P=n(96),M=n(97),F=Object(h.a)(function(){var e=Object(a.useContext)(Q).user,t=Object(l.f)();return r.a.createElement(P.a,{bg:"dark",variant:"dark"},r.a.createElement(o.a,null,e.isAuth?r.a.createElement(M.a,{className:"m-auto",style:{color:"white"}},r.a.createElement(f.a,{variant:"outline-light",onClick:function(){return t("/admin")}},"Admin Panel"),r.a.createElement(f.a,{variant:"outline-light",onClick:function(){return e.setUser({}),e.setIsAuth(!1),void t("/login")}},"Log out")):r.a.createElement(M.a,{className:"m-auto",style:{color:"white"}},r.a.createElement(f.a,{variant:"outline-light",onClick:function(){return t("/login")}},"Authorization"))))}),H=n(62),J=Object(h.a)(function(){var e=Object(a.useContext)(Q).user,t=Object(a.useState)(!0),n=Object(s.a)(t,2),c=n[0],u=n[1];return Object(a.useEffect)(function(){x().then(function(t){e.setUser(!0),e.setIsAuth(!0)}).finally(function(){return u(!1)})},[]),c?r.a.createElement(H.a,{animation:"grow"}):r.a.createElement(D.a,null,r.a.createElement(F,null),r.a.createElement(B,null))}),Y=n(1),q=n(31),T=n(32),G=n(9),K=function(){function e(){Object(q.a)(this,e),this._isAuth=!1,this._user={},this._users=[],Object(G.d)(this)}return Object(T.a)(e,[{key:"setIsAuth",value:function(e){this._isAuth=e}},{key:"setUser",value:function(e){this._user=e}},{key:"setUsers",value:function(e){this._users=e.map(function(e){return Object(Y.a)(Object(Y.a)({},e),{},{selected:!1})}).sort()}},{key:"setStatus",value:function(e){this._users=this._users.map(function(t){return t.selected?Object(Y.a)(Object(Y.a)({},t),{},{status:e}):t})}},{key:"setSelected",value:function(e){this._users=this._users.map(function(t){return t.id===e?Object(Y.a)(Object(Y.a)({},t),{},{selected:!t.selected}):t})}},{key:"setSelectedAll",value:function(e){this._users=this._users.map(function(t){return Object(Y.a)(Object(Y.a)({},t),{},{selected:e})})}},{key:"isAuth",get:function(){return this._isAuth}},{key:"user",get:function(){return this._user}},{key:"getUsers",value:function(){return this._users}},{key:"getStatus",value:function(e){return this._user}}]),e}();n.d(t,"Context",function(){return Q});var Q=Object(a.createContext)(null);u.a.render(r.a.createElement(Q.Provider,{value:{user:new K}},r.a.createElement(J,null)),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.3e7031f5.chunk.js.map